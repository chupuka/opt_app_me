# Инструкция по развертыванию системы ProForm

## Что было создано

### 1. Структура проекта
- ✅ Создан проект ASP.NET Core MVC
- ✅ Настроена структура папок (Models, Controllers, Views, Data)
- ✅ Добавлены необходимые NuGet пакеты

### 2. Модели данных
Созданы следующие модели:
- `Client` - клиенты фитнес-клуба
- `Trainer` - тренеры
- `MembershipType` - типы абонементов
- `Membership` - абонементы клиентов
- `MembershipFreeze` - заморозки абонементов
- `FitnessClass` - занятия
- `ClassRegistration` - записи на занятия
- `Payment` - платежи
- `TrainerSchedule` - расписание тренеров
- `ApplicationUser` - пользователи системы

### 3. База данных
- ✅ Создан `ApplicationDbContext` с настройкой связей
- ✅ Созданы миграции Entity Framework
- ✅ Настроены индексы для производительности

### 4. Аутентификация и авторизация
- ✅ Настроен ASP.NET Core Identity
- ✅ Реализованы роли: Admin, Trainer, Manager
- ✅ Создан `AccountController` для авторизации

### 5. Контроллеры
Созданы контроллеры для всех подсистем:
- ✅ `HomeController` - главная страница с дашбордом
- ✅ `AccountController` - авторизация
- ✅ `ClientsController` - управление клиентами
- ✅ `TrainersController` - управление тренерами
- ✅ `MembershipsController` - продажа и управление абонементами
- ✅ `MembershipTypesController` - управление типами абонементов
- ✅ `ScheduleController` - расписание занятий
- ✅ `ReportsController` - отчеты с экспортом в PDF

### 6. Представления
- ✅ Страница авторизации
- ✅ Главная страница с дашбордом
- ✅ Обновлен Layout с навигацией

## Что нужно доделать

### 1. Представления (Views)
Необходимо создать представления для:
- Список клиентов (Clients/Index.cshtml)
- Карточка клиента (Clients/Details.cshtml)
- Формы создания/редактирования клиентов
- Аналогично для тренеров, абонементов
- Страница расписания с FullCalendar
- Страницы отчетов

### 2. FullCalendar
- Добавить библиотеку FullCalendar через CDN или npm
- Реализовать интерактивный календарь с drag-and-drop
- Настроить API endpoints для работы с событиями

### 3. Инициализация ролей
Создать скрипт или код в `Program.cs` для автоматического создания ролей при первом запуске:
```csharp
using (var scope = app.Services.CreateScope())
{
    var roleManager = scope.ServiceProvider.GetRequiredService<RoleManager<IdentityRole>>();
    var roles = new[] { "Admin", "Trainer", "Manager" };
    foreach (var role in roles)
    {
        if (!await roleManager.RoleExistsAsync(role))
            await roleManager.CreateAsync(new IdentityRole(role));
    }
}
```

### 4. Тесты
Создать тесты согласно сценарию тестов:
- Юнит-тесты контроллеров
- Интеграционные тесты
- Тесты функциональности

### 5. Дополнительные функции
- Валидация данных на клиенте
- Обработка ошибок
- Логирование действий
- Резервное копирование БД

## Инструкция по запуску

1. Установите MySQL Server 8.0
2. Создайте базу данных:
   ```sql
   CREATE DATABASE ProFormDB CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```
3. Обновите строку подключения в `appsettings.json`
4. Примените миграции:
   ```bash
   dotnet ef database update
   ```
5. Запустите приложение:
   ```bash
   dotnet run
   ```
6. Откройте браузер и перейдите по адресу, указанному в консоли (обычно https://localhost:5001)

## Создание первого пользователя-администратора

После запуска приложения необходимо создать первого пользователя. Это можно сделать через:
1. Регистрацию (если реализована)
2. Консольное приложение для инициализации
3. SQL скрипт для прямого добавления в БД

## Примечания

- Проект создан в соответствии с техническим заданием
- Все основные модели и контроллеры реализованы
- Необходимо доработать представления и добавить FullCalendar
- Тесты нужно создать согласно сценарию тестов

